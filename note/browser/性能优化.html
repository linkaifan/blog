<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端性能优化 | Tooyoung_fan</title>
    <meta name="description" content="保持前行、保持记录">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c62923f4.css" as="style"><link rel="preload" href="/blog/assets/js/app.b5895382.js" as="script"><link rel="preload" href="/blog/assets/js/20.dcc9e2fd.js" as="script"><link rel="prefetch" href="/blog/assets/js/19.7881d54c.js"><link rel="prefetch" href="/blog/assets/js/2.e6b027f7.js"><link rel="prefetch" href="/blog/assets/js/3.a87144f6.js"><link rel="prefetch" href="/blog/assets/js/4.343da099.js"><link rel="prefetch" href="/blog/assets/js/5.5c4a3940.js"><link rel="prefetch" href="/blog/assets/js/6.dfa5ab86.js"><link rel="prefetch" href="/blog/assets/js/7.7c5f90e4.js"><link rel="prefetch" href="/blog/assets/js/8.5e0b8797.js"><link rel="prefetch" href="/blog/assets/js/9.26fe9f54.js"><link rel="prefetch" href="/blog/assets/js/10.fe7af515.js"><link rel="prefetch" href="/blog/assets/js/11.d72df0a4.js"><link rel="prefetch" href="/blog/assets/js/12.e25538a7.js"><link rel="prefetch" href="/blog/assets/js/13.14edfc7b.js"><link rel="prefetch" href="/blog/assets/js/14.410563b2.js"><link rel="prefetch" href="/blog/assets/js/15.055d6e3a.js"><link rel="prefetch" href="/blog/assets/js/16.595faa3f.js"><link rel="prefetch" href="/blog/assets/js/17.73a30caf.js"><link rel="prefetch" href="/blog/assets/js/18.2f7e79ce.js"><link rel="prefetch" href="/blog/assets/js/21.fdfb79ac.js"><link rel="prefetch" href="/blog/assets/js/22.ee784cb1.js"><link rel="prefetch" href="/blog/assets/js/23.a0c23ab9.js"><link rel="prefetch" href="/blog/assets/js/24.2d6ad7eb.js"><link rel="prefetch" href="/blog/assets/js/25.10f67a97.js"><link rel="prefetch" href="/blog/assets/js/26.57ae48bb.js"><link rel="prefetch" href="/blog/assets/js/27.726302fb.js"><link rel="prefetch" href="/blog/assets/js/28.defe41b8.js"><link rel="prefetch" href="/blog/assets/js/29.96f32db5.js"><link rel="prefetch" href="/blog/assets/js/30.c2b4208d.js"><link rel="prefetch" href="/blog/assets/js/31.2236f0a6.js"><link rel="prefetch" href="/blog/assets/js/32.f4e47adf.js"><link rel="prefetch" href="/blog/assets/js/33.8edc4215.js"><link rel="prefetch" href="/blog/assets/js/34.46506938.js"><link rel="prefetch" href="/blog/assets/js/35.da95c78a.js"><link rel="prefetch" href="/blog/assets/js/36.f8cae7dd.js"><link rel="prefetch" href="/blog/assets/js/37.7d9ef77f.js"><link rel="prefetch" href="/blog/assets/js/38.5c94fd73.js"><link rel="prefetch" href="/blog/assets/js/39.fbc6734f.js"><link rel="prefetch" href="/blog/assets/js/40.e70f0594.js"><link rel="prefetch" href="/blog/assets/js/41.dcc8d0bc.js"><link rel="prefetch" href="/blog/assets/js/42.232731c1.js"><link rel="prefetch" href="/blog/assets/js/43.30dd1252.js"><link rel="prefetch" href="/blog/assets/js/44.ce4409e3.js"><link rel="prefetch" href="/blog/assets/js/45.0f89fb04.js"><link rel="prefetch" href="/blog/assets/js/46.2354b802.js"><link rel="prefetch" href="/blog/assets/js/47.494dc7db.js"><link rel="prefetch" href="/blog/assets/js/48.30f846db.js"><link rel="prefetch" href="/blog/assets/js/49.b0c89940.js"><link rel="prefetch" href="/blog/assets/js/50.50b558a5.js"><link rel="prefetch" href="/blog/assets/js/51.9b9f1824.js"><link rel="prefetch" href="/blog/assets/js/52.3a65d398.js"><link rel="prefetch" href="/blog/assets/js/53.d5c62db0.js"><link rel="prefetch" href="/blog/assets/js/54.53d08d83.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c62923f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Tooyoung_fan</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">积累</a></div><div class="nav-item"><a href="/blog/utils/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/linkaifan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">积累</a></div><div class="nav-item"><a href="/blog/utils/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/linkaifan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/vue/mvc.html" class="sidebar-link">mvc</a></li><li><a href="/blog/note/vue/响应式原理.html" class="sidebar-link">vue响应式原理</a></li><li><a href="/blog/note/vue/virtualDOM.html" class="sidebar-link">虚拟Dom</a></li><li><a href="/blog/note/vue/生命周期.html" class="sidebar-link">生命周期钩子函数</a></li><li><a href="/blog/note/vue/vue源码解析.html" class="sidebar-link">vue源码解析</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>ES6笔记</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/ES6/" class="sidebar-link">前言</a></li><li><a href="/blog/note/ES6/async.html" class="sidebar-link">async</a></li><li><a href="/blog/note/ES6/object.html" class="sidebar-link">object扩展</a></li><li><a href="/blog/note/ES6/class.html" class="sidebar-link">类</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/mode/singleton.html" class="sidebar-link">单例模式</a></li><li><a href="/blog/note/mode/templateMethod.html" class="sidebar-link">模板方法</a></li><li><a href="/blog/note/mode/watcher.html" class="sidebar-link">观察者模式</a></li><li><a href="/blog/note/mode/factory.html" class="sidebar-link">工厂模式</a></li><li><a href="/blog/note/mode/strategy.html" class="sidebar-link">策略模式</a></li><li><a href="/blog/note/mode/decorator.html" class="sidebar-link">装饰者模式</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/CSS/fontRun.html" class="sidebar-link">文字变色</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>js实现数据结构和算法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/data/stack.html" class="sidebar-link">栈</a></li><li><a href="/blog/note/data/queen.html" class="sidebar-link">队列</a></li><li><a href="/blog/note/data/list.html" class="sidebar-link">链表</a></li><li><a href="/blog/note/data/tree.html" class="sidebar-link">二叉树</a></li><li><a href="/blog/note/data/sort.html" class="sidebar-link">排序算法</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>浏览器以及性能相关</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/browser/browser.html" class="sidebar-link">浏览器</a></li><li><a href="/blog/note/browser/cache.html" class="sidebar-link">缓存</a></li><li><a href="/blog/note/browser/history.html" class="sidebar-link">History 对象</a></li><li><a href="/blog/note/browser/cors.html" class="sidebar-link">CORS</a></li><li><a href="/blog/note/browser/性能优化.html" class="active sidebar-link">前端性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#前端性能优化" class="sidebar-link">前端性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#性能指标" class="sidebar-link">性能指标</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#性能监控performance" class="sidebar-link">性能监控performance</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#减少http请求" class="sidebar-link">减少http请求</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#cdn" class="sidebar-link">CDN</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#缓存" class="sidebar-link">缓存</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#压缩" class="sidebar-link">压缩</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#js" class="sidebar-link">js</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#css" class="sidebar-link">css</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#防抖和节流" class="sidebar-link">防抖和节流</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/性能优化.html#图片" class="sidebar-link">图片</a></li></ul></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>计算机网络</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/network/first.html" class="sidebar-link">DNS服务器和跨域问题</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>js开发N个概念</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/js/执行机制.html" class="sidebar-link">执行机制</a></li><li><a href="/blog/note/js/数组迭代.html" class="sidebar-link">数组迭代</a></li><li><a href="/blog/note/js/垃圾回收机制.html" class="sidebar-link">垃圾回收机制</a></li><li><a href="/blog/note/js/事件机制.html" class="sidebar-link">事件机制</a></li><li><a href="/blog/note/js/web-socket.html" class="sidebar-link">WebSocket</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="前端性能优化"><a href="#前端性能优化" aria-hidden="true" class="header-anchor">#</a> 前端性能优化</h2> <h3 id="性能指标"><a href="#性能指标" aria-hidden="true" class="header-anchor">#</a> 性能指标</h3> <ol><li>首屏First Paint</li></ol> <blockquote><p>浏览器第一次渲染(paint)，在First paint之前是白屏，在这个时间点之后用户就能看到（部分）页面内容。FP发生在body中第一个script脚本之前的CSS解析和JS执行完成之后。换句话说就是第一脚本之前的DOM和CSSOM准备就绪之后，便会着手渲染第一脚本前的内容。如果第一脚本前的JS和CSS加载完了，body中的脚本还未下载完成，那么浏览器就会利用构建好的局部CSSOM和DOM提前渲染第一脚本前的内容（触发FP）；如果第一脚本前的JS和CSS都还没下载完成，body中的脚本就已经下载完了，那么浏览器就会在所有JS脚本都执行完之后才触发FP。</p></blockquote> <ol start="2"><li>DOMContentLoaded</li></ol> <blockquote><p>当文档中没有脚本时，浏览器解析完html文档便能触发 DOMContentLoaded 事件；如果文档中包含脚本，则脚本会阻塞文档的解析，而脚本需要等 CSSOM 构建完成才能执行。在任何情况下，DOMContentLoaded 的触发不需要等待图片等其他资源加载完成。</p></blockquote> <h3 id="性能监控performance"><a href="#性能监控performance" aria-hidden="true" class="header-anchor">#</a> 性能监控performance</h3> <p>Performance 接口可以获取到当前页面中与性能相关的信息,可以通过调用只读属性 Window.performance 来获得。</p> <ul><li>timing: 提供了各种与浏览器处理相关的时间数据</li> <li>navagation: 呈现了如何导航到当前文档的信息。有两个key
<ul><li>type: 表示如何导航到当前页面的，主要有4个值。【0,1,2,255】</li> <li>redirectCount: 表示到达当前页面之前经过几次重定向。</li></ul></li> <li>timeOrigin: 表示performance性能测试开始的时间。是一个高精度时间戳</li> <li>onresourcetimingbufferfull: 表示当浏览器资源时间性能缓冲区已满时会触发的回调函数。</li> <li>mark,measure: 用mark进行打点，就能通过measure取得两个点之间高精度的时间差。【Vue框架就频繁用到了mark和measure来测试程序性能。】</li></ul> <p>常用计算：</p> <ul><li>DNS查询耗时 ：domainLookupEnd - domainLookupStart</li> <li>TCP链接耗时 ：connectEnd - connectStart</li> <li>request请求耗时 ：responseEnd - responseStart</li> <li>解析dom树耗时 ： domComplete - domInteractive</li> <li>白屏时间 ：responseStart - navigationStart</li> <li>domready时间(用户可操作时间节点) ：domContentLoadedEventEnd - navigationStart</li> <li>onload时间(总下载时间) ：loadEventEnd - navigationStart</li></ul> <h3 id="减少http请求"><a href="#减少http请求" aria-hidden="true" class="header-anchor">#</a> 减少http请求</h3> <ul><li>css雪碧图：将所有图片合并成一张大图，使用时再结合background的position等属性来调整抠图。
<ul><li>缺点：开发抠图辛苦，而且会有邻边暴露问题</li></ul></li> <li>合并脚本和样式表：将多个样式表或者脚本文件合并到一个文件中，可以减少HTTP请求的数量从而缩短效应时间。
<ul><li>缺点: 若有更新就需要重下整个文件,且对于模块化开发不友好。</li></ul></li> <li>内联图片：将图片进行base64编码嵌入到文档或样式表中，整个文件会包含图片一起返回而不会产生额外http请求
<ul><li>缺点：不能缓存</li></ul></li></ul> <h3 id="cdn"><a href="#cdn" aria-hidden="true" class="header-anchor">#</a> CDN</h3> <blockquote><p>使用一组分布在不同地方的服务器，根据网络流量，节点链接，负载情况以及用户距离，响应时间等因素将用户请求重定向到对用户来说最优的服务器上</p></blockquote> <p>这样就能缩短响应时间，还能备份，扩展存储，缓解流量峰值等</p> <ul><li>缺点：响应时间可能会受到其他网站流量的影响等。</li></ul> <h3 id="缓存"><a href="#缓存" aria-hidden="true" class="header-anchor">#</a> 缓存</h3> <p>二次访问从本地缓存池中获取，不必每次访问都传输【详情见缓存篇】</p> <h3 id="压缩"><a href="#压缩" aria-hidden="true" class="header-anchor">#</a> 压缩</h3> <p>使用gzip等压缩方式：
请求头：Accept-Encoding: gzip, deflate（表示自己支持的压缩方式）
响应头：Content-Endcding:gzip(实体头，表示实体的压缩方式)</p> <h3 id="js"><a href="#js" aria-hidden="true" class="header-anchor">#</a> js</h3> <p>当 HTML 文档被解析时如果遇见（同步）脚本，则停止解析，先去加载脚本，然后执行，执行结束后继续解析 HTML 文档。</p> <p>优化建议：JS放在 body闭标签 前，或使用异步脚本。</p> <ul><li>异步脚本
<ol><li>defer：在后台加载脚本，文档解析过程不中断，而等文档解析结束之后，defer 脚本执行。另外，defer 脚本的执行顺序与定义时的位置有关。【DOMContentLoaded 只有在 defer 脚本执行结束后才会被触发。】</li> <li>后台加载脚本，文档解析过程不中断。脚本加载完成后，文档停止解析，脚本执行，执行结束后文档继续解析。【DOMContentLoaded 触发，而不需要等待 async 脚本执行、样式表加载等等。】</li></ol></li></ul> <h3 id="css"><a href="#css" aria-hidden="true" class="header-anchor">#</a> css</h3> <p>优化建议：放在head里。</p> <h3 id="防抖和节流"><a href="#防抖和节流" aria-hidden="true" class="header-anchor">#</a> 防抖和节流</h3> <p>详见工具篇。</p> <h3 id="图片"><a href="#图片" aria-hidden="true" class="header-anchor">#</a> 图片</h3> <ul><li>懒加载:只加载自定义区域（通常是可视区域，但也可以是即将进入可视区域）内需要加载的东西。对于图片来说，先设置图片标签的 src 属性为一张占位图，将真实的图片资源放入一个自定义属性中，当进入自定义区域时，就将自定义属性替换为 src 属性，这样图片就会去下载资源，实现了图片懒加载。</li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/blog/assets/js/20.dcc9e2fd.js" defer></script><script src="/blog/assets/js/app.b5895382.js" defer></script>
  </body>
</html>
