<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器 | Tooyoung_fan</title>
    <meta name="description" content="保持前行、保持记录">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c62923f4.css" as="style"><link rel="preload" href="/blog/assets/js/app.b5895382.js" as="script"><link rel="preload" href="/blog/assets/js/16.595faa3f.js" as="script"><link rel="prefetch" href="/blog/assets/js/19.7881d54c.js"><link rel="prefetch" href="/blog/assets/js/2.e6b027f7.js"><link rel="prefetch" href="/blog/assets/js/3.a87144f6.js"><link rel="prefetch" href="/blog/assets/js/4.343da099.js"><link rel="prefetch" href="/blog/assets/js/5.5c4a3940.js"><link rel="prefetch" href="/blog/assets/js/6.dfa5ab86.js"><link rel="prefetch" href="/blog/assets/js/7.7c5f90e4.js"><link rel="prefetch" href="/blog/assets/js/8.5e0b8797.js"><link rel="prefetch" href="/blog/assets/js/9.26fe9f54.js"><link rel="prefetch" href="/blog/assets/js/10.fe7af515.js"><link rel="prefetch" href="/blog/assets/js/11.d72df0a4.js"><link rel="prefetch" href="/blog/assets/js/12.e25538a7.js"><link rel="prefetch" href="/blog/assets/js/13.14edfc7b.js"><link rel="prefetch" href="/blog/assets/js/14.410563b2.js"><link rel="prefetch" href="/blog/assets/js/15.055d6e3a.js"><link rel="prefetch" href="/blog/assets/js/17.73a30caf.js"><link rel="prefetch" href="/blog/assets/js/18.2f7e79ce.js"><link rel="prefetch" href="/blog/assets/js/20.dcc9e2fd.js"><link rel="prefetch" href="/blog/assets/js/21.fdfb79ac.js"><link rel="prefetch" href="/blog/assets/js/22.ee784cb1.js"><link rel="prefetch" href="/blog/assets/js/23.a0c23ab9.js"><link rel="prefetch" href="/blog/assets/js/24.2d6ad7eb.js"><link rel="prefetch" href="/blog/assets/js/25.10f67a97.js"><link rel="prefetch" href="/blog/assets/js/26.57ae48bb.js"><link rel="prefetch" href="/blog/assets/js/27.726302fb.js"><link rel="prefetch" href="/blog/assets/js/28.defe41b8.js"><link rel="prefetch" href="/blog/assets/js/29.96f32db5.js"><link rel="prefetch" href="/blog/assets/js/30.c2b4208d.js"><link rel="prefetch" href="/blog/assets/js/31.2236f0a6.js"><link rel="prefetch" href="/blog/assets/js/32.f4e47adf.js"><link rel="prefetch" href="/blog/assets/js/33.8edc4215.js"><link rel="prefetch" href="/blog/assets/js/34.46506938.js"><link rel="prefetch" href="/blog/assets/js/35.da95c78a.js"><link rel="prefetch" href="/blog/assets/js/36.f8cae7dd.js"><link rel="prefetch" href="/blog/assets/js/37.7d9ef77f.js"><link rel="prefetch" href="/blog/assets/js/38.5c94fd73.js"><link rel="prefetch" href="/blog/assets/js/39.fbc6734f.js"><link rel="prefetch" href="/blog/assets/js/40.e70f0594.js"><link rel="prefetch" href="/blog/assets/js/41.dcc8d0bc.js"><link rel="prefetch" href="/blog/assets/js/42.232731c1.js"><link rel="prefetch" href="/blog/assets/js/43.30dd1252.js"><link rel="prefetch" href="/blog/assets/js/44.ce4409e3.js"><link rel="prefetch" href="/blog/assets/js/45.0f89fb04.js"><link rel="prefetch" href="/blog/assets/js/46.2354b802.js"><link rel="prefetch" href="/blog/assets/js/47.494dc7db.js"><link rel="prefetch" href="/blog/assets/js/48.30f846db.js"><link rel="prefetch" href="/blog/assets/js/49.b0c89940.js"><link rel="prefetch" href="/blog/assets/js/50.50b558a5.js"><link rel="prefetch" href="/blog/assets/js/51.9b9f1824.js"><link rel="prefetch" href="/blog/assets/js/52.3a65d398.js"><link rel="prefetch" href="/blog/assets/js/53.d5c62db0.js"><link rel="prefetch" href="/blog/assets/js/54.53d08d83.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c62923f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Tooyoung_fan</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">积累</a></div><div class="nav-item"><a href="/blog/utils/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/linkaifan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">积累</a></div><div class="nav-item"><a href="/blog/utils/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/linkaifan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/vue/mvc.html" class="sidebar-link">mvc</a></li><li><a href="/blog/note/vue/响应式原理.html" class="sidebar-link">vue响应式原理</a></li><li><a href="/blog/note/vue/virtualDOM.html" class="sidebar-link">虚拟Dom</a></li><li><a href="/blog/note/vue/生命周期.html" class="sidebar-link">生命周期钩子函数</a></li><li><a href="/blog/note/vue/vue源码解析.html" class="sidebar-link">vue源码解析</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>ES6笔记</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/ES6/" class="sidebar-link">前言</a></li><li><a href="/blog/note/ES6/async.html" class="sidebar-link">async</a></li><li><a href="/blog/note/ES6/object.html" class="sidebar-link">object扩展</a></li><li><a href="/blog/note/ES6/class.html" class="sidebar-link">类</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/mode/singleton.html" class="sidebar-link">单例模式</a></li><li><a href="/blog/note/mode/templateMethod.html" class="sidebar-link">模板方法</a></li><li><a href="/blog/note/mode/watcher.html" class="sidebar-link">观察者模式</a></li><li><a href="/blog/note/mode/factory.html" class="sidebar-link">工厂模式</a></li><li><a href="/blog/note/mode/strategy.html" class="sidebar-link">策略模式</a></li><li><a href="/blog/note/mode/decorator.html" class="sidebar-link">装饰者模式</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/CSS/fontRun.html" class="sidebar-link">文字变色</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>js实现数据结构和算法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/data/stack.html" class="sidebar-link">栈</a></li><li><a href="/blog/note/data/queen.html" class="sidebar-link">队列</a></li><li><a href="/blog/note/data/list.html" class="sidebar-link">链表</a></li><li><a href="/blog/note/data/tree.html" class="sidebar-link">二叉树</a></li><li><a href="/blog/note/data/sort.html" class="sidebar-link">排序算法</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>浏览器以及性能相关</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/browser/browser.html" class="active sidebar-link">浏览器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#浏览器" class="sidebar-link">浏览器</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#简介" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#讨论的浏览器" class="sidebar-link">讨论的浏览器</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#主要功能" class="sidebar-link">主要功能</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#高层结构" class="sidebar-link">高层结构</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#呈现引擎" class="sidebar-link">呈现引擎</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#各浏览器引擎" class="sidebar-link">各浏览器引擎</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#主流程" class="sidebar-link">主流程</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#示例" class="sidebar-link">示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#解析和dom树构建" class="sidebar-link">解析和dom树构建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#html解析" class="sidebar-link">html解析</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#css解析" class="sidebar-link">css解析</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#处理js-css顺序" class="sidebar-link">处理js,css顺序</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#呈现树构建" class="sidebar-link">呈现树构建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#流程" class="sidebar-link">流程</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#样式计算" class="sidebar-link">样式计算</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#布局" class="sidebar-link">布局</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#domready" class="sidebar-link">DomReady</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#css-js对dom解析渲染的影响" class="sidebar-link">css,js对dom解析渲染的影响</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#css" class="sidebar-link">css</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#js" class="sidebar-link">js</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#图层" class="sidebar-link">图层</a></li><li class="sidebar-sub-header"><a href="/blog/note/browser/browser.html#重绘repaint和回流reflow" class="sidebar-link">重绘Repaint和回流Reflow</a></li></ul></li></ul></li><li><a href="/blog/note/browser/cache.html" class="sidebar-link">缓存</a></li><li><a href="/blog/note/browser/history.html" class="sidebar-link">History 对象</a></li><li><a href="/blog/note/browser/cors.html" class="sidebar-link">CORS</a></li><li><a href="/blog/note/browser/性能优化.html" class="sidebar-link">前端性能优化</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>计算机网络</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/network/first.html" class="sidebar-link">DNS服务器和跨域问题</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>js开发N个概念</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/note/js/执行机制.html" class="sidebar-link">执行机制</a></li><li><a href="/blog/note/js/数组迭代.html" class="sidebar-link">数组迭代</a></li><li><a href="/blog/note/js/垃圾回收机制.html" class="sidebar-link">垃圾回收机制</a></li><li><a href="/blog/note/js/事件机制.html" class="sidebar-link">事件机制</a></li><li><a href="/blog/note/js/web-socket.html" class="sidebar-link">WebSocket</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="浏览器"><a href="#浏览器" aria-hidden="true" class="header-anchor">#</a> 浏览器</h2> <p></p><div class="table-of-contents"><ul><li><a href="#浏览器">浏览器</a></li><li><a href="#简介">简介</a><ul><li><a href="#讨论的浏览器">讨论的浏览器</a></li><li><a href="#主要功能">主要功能</a></li><li><a href="#高层结构">高层结构</a></li></ul></li><li><a href="#呈现引擎">呈现引擎</a><ul><li><a href="#各浏览器引擎">各浏览器引擎</a></li><li><a href="#主流程">主流程</a></li><li><a href="#示例">示例</a></li></ul></li><li><a href="#解析和dom树构建">解析和dom树构建</a><ul><li><a href="#html解析">html解析</a></li><li><a href="#css解析">css解析</a></li><li><a href="#处理js-css顺序">处理js,css顺序</a></li></ul></li><li><a href="#呈现树构建">呈现树构建</a><ul><li><a href="#流程">流程</a></li><li><a href="#样式计算">样式计算</a></li><li><a href="#布局">布局</a></li><li><a href="#domready">DomReady</a></li></ul></li><li><a href="#css-js对dom解析渲染的影响">css,js对dom解析渲染的影响</a><ul><li><a href="#css">css</a></li><li><a href="#js">js</a></li><li><a href="#图层">图层</a></li><li><a href="#重绘repaint和回流reflow">重绘Repaint和回流Reflow</a></li></ul></li></ul></div><p></p> <h2 id="简介"><a href="#简介" aria-hidden="true" class="header-anchor">#</a> 简介</h2> <p>网络浏览器很可能是使用最广的软件。介绍它们的幕后工作原理。会了解到，从在地址栏输入 baidu.com 直到在浏览器屏幕上看到 baidu 首页的整个过程中都发生了些什么。</p> <h3 id="讨论的浏览器"><a href="#讨论的浏览器" aria-hidden="true" class="header-anchor">#</a> 讨论的浏览器</h3> <p>主流浏览器:Firefox、Chrome 浏览器和 Safari（部分开源）。</p> <h3 id="主要功能"><a href="#主要功能" aria-hidden="true" class="header-anchor">#</a> 主要功能</h3> <p>主要功能就是向服务器发出请求，在浏览器窗口中展示您选择的网络资源。这里所说的资源一般是指 HTML 文档，也可以是 PDF、图片或其他的类型。资源的位置由用户使用 URI（统一资源标示符）指定。</p> <p>浏览器解释并显示 HTML 文件的方式是在 HTML 和 CSS 规范中指定的。这些规范由网络标准化组织 W3C（万维网联盟）进行维护。</p> <h3 id="高层结构"><a href="#高层结构" aria-hidden="true" class="header-anchor">#</a> 高层结构</h3> <ul><li>用户界面：包括地址栏、前进/后退按钮、书签菜单等。除了浏览器主窗口显示的您请求的页面外，其他显示的各个部分都属于用户界面</li> <li>浏览器引擎：在用户界面和呈现引擎之间传送指令</li> <li>呈现引擎：负责显示请求的内容。如果请求的内容是 HTML，它就负责解析 HTML 和 CSS 内容，并将解析后的内容显示在屏幕上</li> <li>网络：用于网络调用，比如 HTTP 请求。其接口与平台无关，并为所有平台提供底层实现</li> <li>用户界面后端：用于绘制基本的窗口小部件，比如组合框和窗口。其公开了与平台无关的通用接口，而在底层使用操作系统的用户界面方法</li> <li>JavaScript 解释器
数据存储：这是持久层。浏览器需要在硬盘上保存各种数据，例如 Cookie。新的 HTML 规范 (HTML5) 定义了“网络数据库”，这是一个完整（但是轻便）的浏览器内数据库。</li></ul> <h2 id="呈现引擎"><a href="#呈现引擎" aria-hidden="true" class="header-anchor">#</a> 呈现引擎</h2> <h3 id="各浏览器引擎"><a href="#各浏览器引擎" aria-hidden="true" class="header-anchor">#</a> 各浏览器引擎</h3> <p>Firefox 使用的是 Gecko，这是 Mozilla 公司“自制”的呈现引擎。而 Safari 和 Chrome 浏览器使用的都是 WebKit。</p> <h3 id="主流程"><a href="#主流程" aria-hidden="true" class="header-anchor">#</a> 主流程</h3> <p>呈现引擎一开始会从网络层获取请求文档的内容，内容的大小一般限制在 8000 个块以内。然后进行基本流程：</p> <ol><li>呈现引擎将开始解析 HTML 文档，并将各标记逐个转化成 “内容树” 上的 DOM 节点。同时也会解析外部 CSS 文件以及样式元素中的样式数据。HTML 中这些带有视觉指令的样式信息将用于创建另一个树结构：“呈现树”。呈现树包含多个带有视觉属性（如颜色和尺寸）的矩形。这些矩形的排列顺序就是它们将在屏幕上显示的顺序。</li> <li>呈现树构建完毕之后，进入“布局”处理阶段，也就是为每个节点分配一个应出现在屏幕上的确切坐标。</li> <li>下一个阶段是绘制 - 呈现引擎会遍历呈现树，由用户界面后端层将每个节点绘制出来。</li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>需要着重指出的是，这是一个渐进的过程。为达到更好的用户体验，呈现引擎会力求尽快将内容显示在屏幕上。它不必等到整个 HTML 文档解析完毕之后，就会开始构建呈现树和设置布局。在不断接收和处理来自网络的其余内容的同时，呈现引擎会将部分内容解析并显示出来。</p></div> <h3 id="示例"><a href="#示例" aria-hidden="true" class="header-anchor">#</a> 示例</h3> <p><img src="/blog/assets/img/webkitflow.85a66640.png" alt="An image"></p> <h2 id="解析和dom树构建"><a href="#解析和dom树构建" aria-hidden="true" class="header-anchor">#</a> 解析和dom树构建</h2> <h3 id="html解析"><a href="#html解析" aria-hidden="true" class="header-anchor">#</a> html解析</h3> <h3 id="css解析"><a href="#css解析" aria-hidden="true" class="header-anchor">#</a> css解析</h3> <h3 id="处理js-css顺序"><a href="#处理js-css顺序" aria-hidden="true" class="header-anchor">#</a> 处理js,css顺序</h3> <ul><li>script：网络的模型是同步的。网页作者希望解析器遇到 script 标记时立即解析并执行js。文档的解析将停止，直到js执行完毕。如果js是外部的，那么解析过程会停止，直到从网络同步抓取资源完成后再继续。此模型已经使用了多年，也在 HTML4 和 HTML5 规范中进行了指定。作者也可以将js标注为“defer”，这样它就不会停止文档解析，而是等到解析结束才执行。HTML5 增加了一个选项，可将js标记为异步，以便由其他线程解析和执行。</li> <li>style: 另一方面，样式表有着不同的模型。理论上来说，应用样式表不会更改 DOM 树，因此似乎没有必要等待样式表并停止文档解析。但这涉及到一个问题，就是js在文档解析阶段会请求【样式信息】。如果当时还没有加载和解析样式，js就会获得错误的回复，这样显然会产生很多问题。这看上去是一个非典型案例，但事实上非常普遍。Firefox 在样式表加载和解析的过程中，会禁止所有js。而对于 WebKit 而言，仅当js尝试访问的样式属性可能受尚未加载的样式表影响时，它才会禁止该js。</li></ul> <h2 id="呈现树构建"><a href="#呈现树构建" aria-hidden="true" class="header-anchor">#</a> 呈现树构建</h2> <p>在 DOM 树构建的同时，浏览器还会构建另一个树结构：呈现树。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>呈现器是和 DOM 元素相对应的，但并非一一对应。非可视化的 DOM 元素不会插入呈现树中，例如“head”元素。如果元素的 display 属性值为“none”，那么也不会显示在呈现树中（但是 visibility 属性值为“hidden”的元素仍会显示）。</p></div> <h3 id="流程"><a href="#流程" aria-hidden="true" class="header-anchor">#</a> 流程</h3> <p>在 Firefox 中，系统会针对 DOM 更新注册展示层，作为侦听器。展示层将框架创建工作委托给 FrameConstructor，由该构造器解析样式（请参阅样式计算）并创建框架。</p> <p>在 WebKit 中，解析样式和创建呈现器的过程称为“附加”。每个 DOM 节点都有一个“attach”方法。附加是同步进行的，将节点插入 DOM 树需要调用新的节点“attach”方法。</p> <h3 id="样式计算"><a href="#样式计算" aria-hidden="true" class="header-anchor">#</a> 样式计算</h3> <h3 id="布局"><a href="#布局" aria-hidden="true" class="header-anchor">#</a> 布局</h3> <p>呈现器在创建完成并添加到呈现树时，并不包含位置和大小信息。计算这些值的过程称为布局或重排。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>全局布局是指触发了整个呈现树范围的布局，触发原因可能包括：
影响所有呈现器的全局样式更改，例如字体大小更改。
屏幕大小调整。</p></div> <h3 id="domready"><a href="#domready" aria-hidden="true" class="header-anchor">#</a> DomReady</h3> <ul><li>Load:指示页面包含图片等文件在内的所有元素都加载完成</li> <li>ready：表示文档结构已经加载完成（不包含图片等非文字媒体文件）</li> <li>DOMContentLoaded: 当页面的DOM树解析好并且需要等待JS执行完才触发，不直接等待CSS文件、图片的加载完成</li> <li>onreadytstatechange：当对象状态变更时触发这个事件，一旦document的readyState属性发生变化就会触发</li></ul> <h2 id="css-js对dom解析渲染的影响"><a href="#css-js对dom解析渲染的影响" aria-hidden="true" class="header-anchor">#</a> css,js对dom解析渲染的影响</h2> <p>一开始学前端，都听过，尽量将css放头部，js放底部，这样可以提高页面的性能。</p> <h3 id="css"><a href="#css" aria-hidden="true" class="header-anchor">#</a> css</h3> <ul><li>结论：CSS 不会阻塞 DOM 的解析，但会阻塞页面渲染</li> <li>原因：浏览器是解析DOM生成DOM Tree，结合CSS生成的CSS Tree，最终组成render tree，再渲染页面。由此可见，在此过程中CSS完全无法影响DOM Tree，因而无需阻塞DOM解析。然而，DOM Tree和CSS Tree会组合成render tree。如果CSS 不会阻塞页面阻塞渲染，那么CSS文件下载之前，浏览器就会渲染出一个浅绿色的div，之后再变成浅蓝色。浏览器的这个策略其实很明智的，想象一下，如果没有这个策略，页面首先会呈现出一个原始的模样，待CSS下载完之后又突然变了一个模样。用户体验可谓极差，而且渲染是有成本的。因此，基于性能与用户体验的考虑，浏览器会尽量减少渲染的次数，CSS顺理成章地阻塞页面渲染。也有另外的情况，css会影响js执行，只有当解析完样式表才会执行 JS，所以也可以认为这种情况下，CSS 也会暂停构建 DOM。</li></ul> <h3 id="js"><a href="#js" aria-hidden="true" class="header-anchor">#</a> js</h3> <ul><li>结论：JS 阻塞 DOM 解析</li> <li>浏览器遇到 script 且没有defer或async属性的 标签时，会触发页面渲染，因而如果前面CSS资源尚未加载完毕时，浏览器会等待它加载完毕在执行脚本。</li></ul> <h3 id="图层"><a href="#图层" aria-hidden="true" class="header-anchor">#</a> 图层</h3> <blockquote><p>一般来说，可以把普通文档流看成一个图层。特定的属性可以生成一个新的图层。不同的图层渲染互不影响，所以对于某些频繁需要渲染的建议单独生成一个新图层，提高性能。但也不能生成过多的图层，会引起反作用。</p></blockquote> <p>通过以下几个常用属性可以生成新图层:</p> <ul><li>3D:translate3d、translateZ</li> <li>will-change</li> <li>video,iframe 标签</li> <li>position: fixed</li></ul> <h3 id="重绘repaint和回流reflow"><a href="#重绘repaint和回流reflow" aria-hidden="true" class="header-anchor">#</a> 重绘Repaint和回流Reflow</h3> <ul><li>重绘是当节点需要更改外观而不会影响布局的，比如改变 color 就叫称为重绘</li> <li>回流是布局或者几何属性需要改变就称为回流。
回流必定会发生重绘，重绘不一定会引发回流。回流所需的成本比重绘高的多，改变深层次的节点很可能导致父节点的一系列回流。</li></ul> <p>优化建议：</p> <ul><li>使用 visibility 替换 display: none ，因为前者只会引起重绘，后者会引发回流（改变了布局）</li> <li>把 DOM 离线后修改，比如：先把 DOM 给 display:none (有一次 Reflow)，然后你修改100次，然后再把它显示出来</li> <li>不要把 DOM 结点的属性值放在一个循环里当成循环里的变量</li> <li>将频繁运行的动画变为图层，图层能够阻止该节点回流影响别的元素。比如对于 video 标签，浏览器会自动将该节点变为图层。</li> <li>动画实现的速度的选择，动画速度越快，回流次数越多，也可以选择使用 requestAnimationFrame</li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/note/data/sort.html" class="prev">
          排序算法
        </a></span> <span class="next"><a href="/blog/note/browser/cache.html">
          缓存
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/16.595faa3f.js" defer></script><script src="/blog/assets/js/app.b5895382.js" defer></script>
  </body>
</html>
